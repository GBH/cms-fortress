- content_for :right_column do
  #form-save.box
    %label.checkbox-inline
      %input{:type => 'checkbox'}
      = ::Comfy::Cms::Page.human_attribute_name(:is_published)
    %button.btn.btn-sm.btn-primary.pull-right
  = render 'comfy/admin/cms/files/index'

= render 'comfy/admin/cms/partials/page_form_before', :object => form

- if Cms::Fortress.configuration.enable_page_workflow && !@page.new_record?
  .container-fluid
    .btn-group
      %span.btn.btn-success= @page.aasm_state.titleize
      - page_actions(@page).each do |page_action|
        = form.button t('.'+page_action.to_s), :class => 'btn btn-default', :value => page_action, :name => 'transition'
  %hr

= form.text_field :label, :data => {:slugify => @page.new_record?}

- unless @site.pages.count == 0 || @site.pages.root == @page
  = form.text_field :slug, :data => {:slug => true}
  - unless @page.new_record?
    = form.text_field :full_path, :id => 'full-path', :disabled => true

- if (options = ::Comfy::Cms::Layout.options_for_select(@site)).present?
  = form.select :layout_id, options, {}, 'data-url' => form_blocks_comfy_admin_cms_site_page_path(@site, @page.id.to_i)
  
- if (options = ::Comfy::Cms::Page.options_for_select(@site, @page)).present?
  = form.select :parent_id, options

- if (options = ::Comfy::Cms::Page.options_for_select(@site, @page, nil, 0, false)).present?
  = form.select :target_page_id, [["---- #{t('.select_target_page')} ----", nil]] + options

= render 'comfy/admin/cms/partials/page_form_inner', :object => form

= render :partial => 'comfy/admin/cms/categories/form', :object => form

= render :partial => 'form_blocks'

- unless Cms::Fortress.configuration.enable_page_workflow
  = form.check_box :is_published, :label => t('.is_published')
= render :partial => 'cms/fortress/shared/page_extend', :locals => {form: form}

= render 'comfy/admin/cms/partials/page_form_after', :object => form

= form.form_group :class => 'form-actions' do
  = form.button t('.preview'), :name => 'preview', :id => nil, :class => 'btn btn-default'
  = form.button t(@page.new_record?? '.create' : '.update'), :class => 'btn btn-primary', :value => 'save', :name => 'commit'

= render :partial => 'cms/fortress/shared/page_extend_js'
